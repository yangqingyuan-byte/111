# Daubechies 4 (db4) 小波基函数数学形式

## 1. 基本定义

**Daubechies 4 (db4)** 是 Daubechies 小波族中的一员，由 Ingrid Daubechies 在1988年提出。它是具有4个消失矩（vanishing moments）的紧支撑正交小波。

## 2. 滤波器系数

db4 小波由两个滤波器定义：
- **低通滤波器 (dec_lo)**: 用于提取低频成分
- **高通滤波器 (dec_hi)**: 用于提取高频成分

### 2.1 低通滤波器系数 (dec_lo)

db4 的低通滤波器有 **8个系数**（长度为4的小波对应2N=8个系数）。

**理论公式**（标准形式）：
```
h[0] = (1 + √3) / (4√2) ≈ 0.230377813308896
h[1] = (3 + √3) / (4√2) ≈ 0.714846570552915
h[2] = (3 - √3) / (4√2) ≈ 0.630880767929859
h[3] = (1 - √3) / (4√2) ≈ -0.027983769416859
```

**实际使用**（PyWavelets 返回的完整8个系数，包含扩展）：
```
dec_lo = [
    -0.010597401785069032,  0.0328830116668852,
     0.030841381835560764, -0.18703481171909309,
    -0.027983769416859854,  0.6308807679298589,
     0.7148465705529157,    0.2303778133088965
]
```

**注意**: PyWavelets 的实现可能对系数进行了重新排序或扩展，但数学性质（正交性、归一化等）保持不变。

### 2.2 高通滤波器系数 (dec_hi)

高通滤波器通过低通滤波器的交替反转得到（QMF 关系）：

```
dec_hi[k] = (-1)^k · dec_lo[N-1-k]
```

对于 db4 (N=4)：
```
dec_hi = [
    (1 - √3) / (4√2),   # = (-1)^0 · dec_lo[3]
    -(3 - √3) / (4√2),  # = (-1)^1 · dec_lo[2]
    (3 + √3) / (4√2),   # = (-1)^2 · dec_lo[1]
    -(1 + √3) / (4√2)   # = (-1)^3 · dec_lo[0]
]
```

## 3. 数学性质

### 3.1 归一化条件

滤波器系数满足：
```
Σ h[k]² = 1
Σ h[k] = √2
```

### 3.2 正交性条件

```
Σ h[k] · h[k-2n] = δ[n]  (Kronecker delta)
```

### 3.3 消失矩 (Vanishing Moments)

db4 具有 **4个消失矩**，意味着：
```
∫ t^m · ψ(t) dt = 0,  m = 0, 1, 2, 3
```
其中 ψ(t) 是小波函数。

## 4. 尺度函数和小波函数

### 4.1 尺度函数 (Scaling Function) φ(t)

db4 的尺度函数满足双尺度方程：
```
φ(t) = √2 · Σ h[k] · φ(2t - k)
       k=0,1,2,3
```

### 4.2 小波函数 (Wavelet Function) ψ(t)

小波函数由尺度函数定义：
```
ψ(t) = √2 · Σ g[k] · φ(2t - k)
       k=0,1,2,3
```
其中 `g[k] = (-1)^k · h[3-k]` 是高通滤波器系数。

## 5. 在代码中的使用

在 `T3Time小波包分解版本.py` 中：

```python
import pywt

wavelet_obj = pywt.Wavelet('db4')
dec_lo = wavelet_obj.dec_lo  # 低通滤波器系数
dec_hi = wavelet_obj.dec_hi  # 高通滤波器系数
```

### 5.1 分解过程

对于输入信号 x[n]，分解过程为：

**低频成分 (cA)**:
```
cA[k] = Σ x[n] · dec_lo[2k - n]
        n
```

**高频成分 (cD)**:
```
cD[k] = Σ x[n] · dec_hi[2k - n]
        n
```

## 6. 数值示例

### db4 滤波器系数（精确值，来自 PyWavelets）

**低通滤波器 (dec_lo)** - 长度为 8:
```
[-0.010597401785069032,  0.0328830116668852,
  0.030841381835560764, -0.18703481171909309,
 -0.027983769416859854,  0.6308807679298589,
  0.7148465705529157,    0.2303778133088965]
```

**高通滤波器 (dec_hi)** - 长度为 8:
```
[-0.2303778133088965,    0.7148465705529157,
 -0.6308807679298589,   -0.027983769416859854,
  0.18703481171909309,   0.030841381835560764,
 -0.0328830116668852,   -0.010597401785069032]
```

**注意**: PyWavelets 返回的系数顺序可能与理论公式的顺序不同，但数学性质相同。

## 7. 特性总结

| 特性 | 值 |
|------|-----|
| **支撑长度** | 2N-1 = 7 |
| **滤波器长度** | 2N = 8 |
| **消失矩数** | N = 4 |
| **正则性** | 约 1.0 |
| **对称性** | 非对称 |
| **正交性** | 是 |
| **紧支撑** | 是 |

## 8. 为什么选择 db4？

1. **平衡性**: 在时频分辨率之间取得良好平衡
2. **消失矩**: 4个消失矩使其能很好地表示平滑信号
3. **紧支撑**: 计算效率高，适合实时处理
4. **广泛应用**: 在信号处理、图像压缩等领域广泛使用

## 9. 与其他小波的比较

| 小波类型 | 消失矩 | 支撑长度 | 对称性 |
|---------|--------|----------|--------|
| **db4** | 4 | 7 | 非对称 |
| haar | 1 | 1 | 对称 |
| db2 | 2 | 3 | 非对称 |
| db8 | 8 | 15 | 非对称 |

## 10. 数学公式总结

### 双尺度方程
```
φ(t) = √2 · Σ h[k] · φ(2t - k)
       k=0,1,2,3

ψ(t) = √2 · Σ g[k] · φ(2t - k)
       k=0,1,2,3
```

### 滤波器系数
```
h[0] = (1 + √3) / (4√2)
h[1] = (3 + √3) / (4√2)
h[2] = (3 - √3) / (4√2)
h[3] = (1 - √3) / (4√2)

g[k] = (-1)^k · h[3-k]
```

### 分解公式
```
cA[k] = Σ x[n] · h[2k - n]
cD[k] = Σ x[n] · g[2k - n]
```

## 参考文献

1. Daubechies, I. (1988). "Orthonormal bases of compactly supported wavelets"
2. Mallat, S. (2009). "A Wavelet Tour of Signal Processing"
3. PyWavelets Documentation: https://pywavelets.readthedocs.io/
